#!/usr/bin/env python3

from scapy.all import *

mapping = {
0x00 :"",
0x01 :"",
0x02 :"",
0x03 :"",
0x04 :"a",
0x05 :"b",
0x06 :"c",
0x07 :"d",
0x08 :"e",
0x09 :"f",
0x0A :"g",
0x0B :"h",
0x0C :"i",
0x0D :"j",
0x0E :"k",
0x0F :"l",
0x10 :"m",
0x11 :"n",
0x12 :"o",
0x13 :"p",
0x14 :"q",
0x15 :"r",
0x16 :"s",
0x17 :"t",
0x18 :"u",
0x19 :"v",
0x1A :"w",
0x1B :"x",
0x1C :"y",
0x1D :"z",
0x1E :"1",
0x1F :"2",
0x20 :"3",
0x21 :"4",
0x22 :"5",
0x23 :"6",
0x24 :"7",
0x25 :"8",
0x26 :"9",
0x27 :"0",
0x28 :"Return",
0x29 :"ESCAPE",
0x2A :"DELETE",
0x2B :"Tab",
0x2C :"Spacebar",
0x2D :"-",
0x2E :"=",
0x2F :"{",
0x30 :"}",
0x31 :"|",
0x32 :"Non-US",
0x33 :";",
0x34 :"â€˜",
0x35 :"~",
0x36 :"and",
0x37 :".",
0x38 :"/",
0x39 :"CapsLock",
0x3A :"F1",
0x3B :"F2",
0x3C :"F3",
0x3D :"F4",
0x3E :"F5",
0x3F :"F6",
0x40 :"F7",
0x41 :"F8",
0x42 :"F9",
0x43 :"F10",
0x44 :"F11",
0x45 :"F12",
0x46 :"PrintScreen",
0x47 :"Scroll",
0x48 :"Pause",
0x49 :"Insert",
0x4A :"Home",
0x4B :"PageUp",
0x4C :"Delete",
0x4D :"End",
0x4E :"PageDown",
0x4F :"RightArrow",
0x50 :"LeftArrow",
0x51 :"DownArrow",
0x52 :"UpArrow",
0x53 :"NumLock",
0x54 :"/",
0x55 :"*",
0x56 :"-",
0x57 :"+",
0x58 :"ENTER",
0x59 :"1",
0x5A :"2",
0x5B :"3",
0x5C :"4",
0x5D :"5",
0x5E :"6",
0x5F :"7",
0x60 :"8",
0x61 :"9",
0x62 :"0",
0x63 :".",
0x64 :"|",
0x65 :"Application",
0x66 :"Power",
0x67 :"=",
0x68 :"F13",
0x69 :"F14",
0x6A :"F15",
0x6B :"F16",
0x6C :"F17",
0x6D :"F18",
0x6E :"F19",
0x6F :"F20",
0x70 :"F21",
0x71 :"F22",
0x72 :"F23",
0x73 :"F24"
}

flag = []

packets = rdpcap('henpeck.pcap')
for each_packet in packets:
	special_byte = each_packet[0].load[-6]
	flag.append(mapping[special_byte])
	
print("".join(flag))

